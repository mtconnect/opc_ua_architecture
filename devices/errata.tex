% ************************************************************************* %
% ********************** MTCONNECT DOCUMENT TEMPLATE ********************** %
% ************************************************************************* %
% 	FILENAME: 		mtconnect.tex											%
%	VERSION:		0.1														%
% 	DATE:			02/13/2018												%
%	PORTED BY:		Moneer Helu												%
%	ADDRESS:		Engineering Laboratory									%
%					National Institute of Standards and Technology (NIST)	%
%					100 Bureau Drive										%
%					Mailstop 8260											%
%					Gaithersburg, MD 20899									%
%					United States of America								%
% 	EMAIL:			moneer.helu@nist.gov									%
% 	DESCRIPTION:	Template for MTConnect documentation;					%
% 					Initial attempt for testing and discussion				%
% 	USAGE:			\documentclass[options]{mtconnect}						%
% ************************************************************************* %

\documentclass{mtc-opc}	% Load mtconnect document class

\usepackage[
backend=biber,
style=alphabetic,
]{biblatex}

\definecolor{light-gray}{gray}{0.90}

\addbibresource{opc.bib}
\addbibresource{mtc.bib}
\addbibresource{references.bib}

\defbibheading{bibliography}[\bibname]{%
  \subsection{#1}}
  
%Package for subsubsubsection/paragraph command
\usepackage{titlesec}
\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% Initialize the glossaries and acronyms
\input{acronyms.tex}
\input{opc-terms.tex}
\input{mtc-terms.tex}

\begin{document}			% Begin document here

% ************************************************************************* %
% *********************** REQUIRED INITIAL INPUTS ************************* %
% ************************************************************************* %

\docnum{OPC 30070-1}							% Document "number"
\doctitleshort{OPC UA for \mtconnect}		% Shortened document title
\doctitle{\getdocnum: \getdoctitleshort}
\doctitlepart{ERRATA}
\doctitlesubpart{-- Errata}
\doctitledesc{}
\versionnum{2.00.01}						% MTConnect version

\preparedfor{MTConnect Institute and OPC Foundation}		% Should not change!!!
\preparedby{MTConnect Institute, OPC Foundation}				% Author
\preparedon{\today}			% Date prepared
\versiontext{Release}

% ************************************************************************* %
% ******************* FRONT MATTER (DO NOT CHANGE!!!) ********************* %
% ************************************************************************* %

\begin{nolinenumbers}
	\maketitle				% Title page

\pagenumbering{roman}

\begin{mdframed}[innerleftmargin=0pt,innerrightmargin=0pt,%
  backgroundcolor=light-gray,linewidth=1pt]%
  \fontsize{9pt}{11pt}\selectfont
  \tabulinesep=8pt
  \taburowcolors[1]{light-gray .. light-gray}
  \taburulecolor |light-gray|{black}
  \begin{tabu} to 5.75in {X[0.6] X X[0.3] X[1.1]}
    Specification Type: & Industry Standard Specification & Comments: & \\ \tabucline[1pt]{2-2} \tabucline[1pt]{4-4}
    Document Number & \bfseries{ \getdocnum } & & \\ \tabucline[1pt]{2-2}
    Title: & {\getdoctitleshort \newline \getdoctitlepart \newline \gettitledesc} & Date: & \today \\  \tabucline[1pt]{2-2} \tabucline[1pt]{4-4}
    Version: & \getversiontext\ \getversionnum & Software: & LaTeX  \\ \tabucline[1pt]{2-2} \tabucline[1pt]{4-4}
    Authors: & William Sobel & Source: & OPC 30070 – UA CS for MTConnect – Errata 2.00.01.pdf \\  \tabucline[1pt]{2-2} \tabucline[1pt]{4-4}
    Owner: & MTConnect Institute & Status: &  \getversiontext \\
  \end{tabu}
\end{mdframed}

\textbf{\Large {Document History}}

\begin{table}[ht]
    \centering
    \fontsize{9pt}{11pt}\selectfont
    \tabulinesep=3pt
    \begin{tabu} to 6in {|X[-1]|X[-1.25]|X[-0.75]|X[5.25]|X[-0.75]|} \everyrow{\hline}
        \hline
        \rowfont \bfseries Version & Date & Reason & Comments & Mantis \\        
        2.00.01 & 2019-11-01 & Revision & Mapping the Native Code to a Condition Branch Semantic Correction & \mantis{4883} \\
    \end{tabu}
\end{table}

\clearpage
\tableofcontents
\thispagestyle{fancy}

\clearpage

\end{nolinenumbers}

\input 00-legal.tex

% ************************************************************************* %
% ******************** ENTER DOCUMENT CONTENT BELOW *********************** %
% ************************************************************************* %
\glsresetall
\pagenumbering{arabic}

\clearpage

\begin{center}
  \Large{OPC UA for MTConnect Errata Specification}
\end{center}

\section{Scope}

This Errata document contains known corrections and additions to all parts for version 2.00 of OPC 30070 – UA for MTConnect. This document is updated regularly when issues are found or enhancements are made between major releases of the specification.

If anything in the Errata affects the NodeSet, a new NodeSet will be published with a reference to the version and date of this Errata document.

\section{\getdocnum:  Part 1 – Device Model}
\FloatBarrier

\begin{table}[ht]
  \centering 
  \tabulinesep=6pt
  \begin{tabu} to 6in {|X[0.4]|X|} \everyrow{\hline}
    \hline
    \bfseries {Topic} & {Mapping the Native Code to a Condition Branch Semantic Correction} \\
    \bfseries {Errata Version} & 2.00.01 \\
    \bfseries {Spec Reference} & {Amendment 1 – Conditions} \\
    \bfseries {Mantis Reference} & \mantis{4883} \\
    \bfseries {Problem Statement} & \small{
      While mapping an MTConnect NativeCode to the OPC UA Condition BranchID may technically allow OPC UA to represent all the possible states of the MTConnect system, it is semantically not the same meaning, and standard OPC UA Client tools will create misleading views of these systems states.
      
      \vspace{6pt}
      From the \cite{UAPart9} page 5:
      \textit{Condition instances are specific implementations of a ConditionType. It is up to the Server whether such instances are also exposed in the Server’s AddressSpace. Clause 4.10 provides additional background about Condition instances. Condition instances shall have a unique identifier to differentiate them from other instances. This is independent of whether they are exposed in the AddressSpace. As mentioned above, Conditions represent the state of a system or one of its components.}
      } \\
  \end{tabu}
\end{table}

\textit{Continued next page...}

\begin{table}[ht]
  \centering 
  \tabulinesep=6pt
  \begin{tabu} to 6in {|X[0.4]|X|} \everyrow{\hline}
    \hline
    \bfseries {Problem Statement
      (Continued)} & \small{
      The different native Codes in MTConnect represent different conditions. They do not represent ID's for previous occurrences of the same condition. Each NativeCode is a different condition. Each native Code will have a different operator action to resolve, there is no notion of the them representing previous occurrences of interest of the same condition like the OPC UA BranchId.

      \vspace{6pt}
      From the \cite{UAPart9} Page 5:
      \textit{In certain cases, however, previous states that still need attention also have to be maintained. ConditionBranches are introduced to deal with this requirement and distinguish current state and previous states. Each ConditionBranch has a BranchId that differentiates it from other branches of the same Condition instance. The ConditionBranch which represents the current state of the Condition (the trunk) has a NULL BranchId.}
     } \\
    \hline
    \bfseries {Solution} &
    {
      The change removes the use of branches to differentiate individual \mtmodel{Condition} activation and relies on the \uamodel{ConditionType} \uamodel{Event} mechanism to manage the \mtmodel{Condition} states.
      \vspace{6pt}
      
      The solution separates out the \mtuatype{MTConnditionType} representing meta-data and the \mtuatype{MTConditionEventType} that represents the information reported when a \mtmodel{Warning} or \mtmodel{Fault} occurs. Each unique condition invocation, usually distinguished by the \mtmodel{nativeCode} will become a new \mtuatype{MTConditionEventType} with a unique \uamodel{ConditionId} given as the \uamodel{NodeId} of the \uamodel{Event} and a composed unique \uamodel{ConditionName} composed from the unique attributes of the \mtmodel{Condition} in the stream document.

      \vspace{6pt}
      The \uamodel{Event} connects to the \mtuamodel{MTConditionType} meta-data \uamodel{Object} with the \uamodel{SourceNode} and \uamodel{SourceName} properties.

      Changes will be provide in \textit{OPC 30070 OPC-UA for MTConnect Part 1: Device Model Amendment 1}
      
      \vspace{12pt}
      \textbf{Modified Sections:}
      \begin{itemize}
        \item Modifications to Section~8.4.6 \textit{Conditions}
        \item Modifications to Section~9.4 \textit{Conditions}
      \end{itemize}
    }\\
  \end{tabu}
\end{table}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
